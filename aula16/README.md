this is just a mess and i'm not sure i'll ever fix it